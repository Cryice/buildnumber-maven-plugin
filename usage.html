<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2015-05-17
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20150517" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Build Number Maven Plugin &#x2013; Usage</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.0.min.js"></script>

    
            </head>
        <body class="topBarDisabled">
          
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                                  <a href=".." id="bannerLeft">
                                                                                                <img src="../images/mojo_logo.png"  alt="Mojo"/>
                </a>
                      </div>
        <div class="pull-right">                  <a href="http://www.codehaus.org" id="bannerRight">
                                                                                                <img src="../images/codehaus-small.png"  alt="Codehaus"/>
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                              <li class="">
                    <a href="http://codehaus.org/" class="externalLink" title="Codehaus">
        Codehaus</a>
        </li>
      <li class="divider ">/</li>
            <li class="">
                    <a href="../" title="Mojo">
        Mojo</a>
        </li>
      <li class="divider ">/</li>
                <li class="">
                    <a href="./" title="Build Number Maven Plugin">
        Build Number Maven Plugin</a>
        </li>
      <li class="divider ">/</li>
        <li class="">Usage</li>
        
                
                    
                  <li id="publishDate" class="pull-right">Last Published: 2015-05-17</li> <li class="divider pull-right">|</li>
              <li id="projectVersion" class="pull-right">Version: 1.4-SNAPSHOT</li>
            
                                            <li class="divider pull-right">|</li>
                        
    <li class="pull-right">              <a href="http://maven.apache.org/" class="externalLink" title="Maven">
        Maven</a>
  </li>

                        </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Overview</li>
                                
      <li>
    
                          <a href="index.html" title="Introduction">
          <i class="none"></i>
        Introduction</a>
            </li>
                  
      <li>
    
                          <a href="plugin-info.html" title="Goals">
          <i class="none"></i>
        Goals</a>
            </li>
                  
      <li class="active">
    
            <a href="#"><i class="none"></i>Usage</a>
          </li>
                  
      <li>
    
                          <a href="faq.html" title="FAQ">
          <i class="none"></i>
        FAQ</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                                                                        
      <li>
    
                          <a href="project-info.html" title="Project Information">
          <i class="icon-chevron-right"></i>
        Project Information</a>
                  </li>
                                                                                                                                                                                                                                      
      <li>
    
                          <a href="project-reports.html" title="Project Reports">
          <i class="icon-chevron-right"></i>
        Project Reports</a>
                  </li>
            </ul>
                
                    
                            <form id="search-form" action="http://www.google.com/search" method="get" >
    
  <input value="mojo.codehaus.org" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="http://www.google.com/coop/cse/brand?form=search-form"></script>
          
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <div class="section">
<h2><a name="Usage"></a>Usage</h2>
<p>This plugin works in one of 3 ways: with an SCM, with a sequential build number, or with a timestamp.</p>
<p>No matter which method you choose, you must include it in your pom:</p>
<div class="source">
<pre>  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
        &lt;artifactId&gt;buildnumber-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;1.4-SNAPSHOT&lt;/version&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;phase&gt;validate&lt;/phase&gt;
            &lt;goals&gt;
              &lt;goal&gt;create&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
        &lt;configuration&gt;
          &lt;doCheck&gt;true&lt;/doCheck&gt;
          &lt;doUpdate&gt;true&lt;/doUpdate&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;</pre></div>
<p>This will cause the create goal of the buildNumber plugin to be executed during the validate phase. It will first check to see if you have locally modified files, and will fail if there are any. You can suppress this behaviour with <tt>-Dmaven.buildNumber.doCheck=false</tt> (or remove/change the configuration info).</p>
<p>The buildNumber plugin will then update your local repository. This is done because local revision might not be the same locally as the last one on some remote server (example for svn: 'svn info' grabs the revision out of your local repository, and is not necessarily the same as the revision in the remote repository). You should probably deal with these changes before creating a build in any case. Again, this behaviour can be suppressed with <tt>-Dmaven.buildNumber.doUpdate=false</tt>.</p>
<p>You then need to do something with the revision provided by the plugin. The revision number is available using <tt>${buildNumber}</tt> in your pom. For example:</p>
<div class="source">
<pre>  &lt;build&gt;
    &lt;finalName&gt;$\{project.artifactId}-$\{project.version}-r$\{buildNumber}&lt;/finalName&gt;
  &lt;/build&gt;</pre></div>
<p>or to place in the manifest (META-INF/MANIFEST.mf) of your jar:</p>
<div class="source">
<pre>  &lt;build&gt;
    ...
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.1&lt;/version&gt;
        &lt;configuration&gt;
          &lt;archive&gt;
            &lt;manifest&gt;
              &lt;addDefaultImplementationEntries&gt;true&lt;/addDefaultImplementationEntries&gt;
            &lt;/manifest&gt;
            &lt;manifestEntries&gt;
              &lt;Implementation-Build&gt;$\{buildNumber}&lt;/Implementation-Build&gt;
            &lt;/manifestEntries&gt;
          &lt;/archive&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;</pre></div>
<p>or war:</p>
<div class="source">
<pre>  &lt;build&gt;
    ...
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.0.2&lt;/version&gt;
        &lt;configuration&gt;
          &lt;archive&gt;
            &lt;manifest&gt;
              &lt;addDefaultImplementationEntries&gt;true&lt;/addDefaultImplementationEntries&gt;
            &lt;/manifest&gt;
            &lt;manifestEntries&gt;
              &lt;Implementation-Build&gt;$\{buildNumber}&lt;/Implementation-Build&gt;
            &lt;/manifestEntries&gt;
          &lt;/archive&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;</pre></div>
<p>The <tt>${scmBranch}</tt> property is also populated to provide the SCM branch.</p>
<p><b>Note:</b> Older version of the jar and war plugin don't require the manifest/addDefaultImplementationEntries element, and in fact will fail if present. The new versions require this element.</p>
<p>You can also configure the plugin to be more flexible.</p>
<div class="source">
<pre>  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
        &lt;artifactId&gt;buildnumber-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;1.4-SNAPSHOT&lt;/version&gt;
        &lt;configuration&gt;
          &lt;format&gt;At {1,time} on {1,date}, there was {2} on planet {0,number,integer}.&lt;/format&gt;
          &lt;items&gt;
            &lt;item implementation=&quot;java.lang.Integer&quot;&gt;7&lt;/item&gt;
            &lt;item&gt;timestamp&lt;/item&gt;
            &lt;item&gt;a disturbance in the Force&lt;/item&gt;
          &lt;/items&gt;
        &lt;/configuration&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;phase&gt;validate&lt;/phase&gt;
            &lt;goals&gt;
              &lt;goal&gt;create&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;</pre></div>
<p>Other more useful configurations might be:</p>
<div class="source">
<pre>    &lt;configuration&gt;
      &lt;format&gt;{0,number}.{1,number}.{2,number}&lt;/format&gt;
      &lt;items&gt;
        &lt;item&gt;buildNumber0&lt;/item&gt;
        &lt;item&gt;buildNumber1&lt;/item&gt;
        &lt;item&gt;buildNumber2&lt;/item&gt;
      &lt;/items&gt;
    &lt;/configuration&gt;</pre></div>
<p>or:</p>
<div class="source">
<pre>    &lt;configuration&gt;
      &lt;format&gt;{0,date,yyyy-MM-dd HH:mm:ss}&lt;/format&gt;
      &lt;items&gt;
        &lt;item&gt;timestamp&lt;/item&gt;
      &lt;/items&gt;
    &lt;/configuration&gt;</pre></div>
<p>The plugin simply uses the <a class="externalLink" href="http://java.sun.com/j2se/1.4.2/docs/api/java/text/MessageFormat.html"> MessageFormat class</a> to produce <tt>${buildNumber}</tt>, and thus the above configurations would produce:</p>
<div class="source">
<pre>    At 12:30 PM on Jul 3, 2053, there was a disturbance in the Force on planet 7.</pre></div>
<p>and</p>
<div class="source">
<pre>    2.0.3</pre></div>
<p>and</p>
<div class="source">
<pre>    2005-10-06 2:22:55</pre></div>
<p>respectively.</p>
<p>When you specify the special items of &quot;buildNumber\d*&quot; or &quot;timestamp&quot;, then some magic is performed. For each unique buildNumber, a properties file ( see <a href="./create-mojo.html#buildNumberPropertiesFileLocation">buildNumberPropertiesFileLocation</a> ) will be created (or read if it exists) which holds an integer, starting at 1. That number will be incremented on each access. Of course, the given example is somewhat non-sensical, since it will increment all 3 numbers on each build, but it shows the type of flexibility available. For each timestamp, you simply get the current date and time.</p>
<p>Here is some additional writeup on <a class="externalLink" href="http://apollo.ucalgary.ca/tlcprojectswiki/index.php/Public/Project_Versioning_-_Best_Practices#Build_Versioning"> how to version your projects with this plugin</a>. It even details how to access the version number in your code.</p>
<div class="section">
<h3><a name="Git_short_revision_ID"></a>Git short revision ID</h3>
<p>From the version 1.1 you can specify the length for the Git revision. To enable this feature you have to specify the new tag <b> &lt;shortRevisionLength&gt; </b> in the <b> &lt;configuration&gt; </b> section. For exemple:</p>
<div class="source">
<pre>    &lt;configuration&gt;
       &lt;shortRevisionLength&gt;5&lt;/shortRevisionLength&gt;
    &lt;/configuration&gt;</pre></div>
<p>the output of the found git revision will have only 5 characters:</p>
<div class="source">
<pre>    instead of b0c1c69be579175e63eeb1c056d607f01ab61e96 you will have only b0c1c</pre></div>
<p><b>Note:</b> this feature uses internally the <b>git rev-pasre --short</b> command and the revision length is set to minimum 4 characters. So you can't have the revision id shorter then 4 characters. Even if you specify the length between 0 and 4, the plugin will inform you about this situation and the minimum value (4) will be used.</p></div>
<div class="section">
<h3><a name="Using_svnjava_provider"></a>Using svnjava provider</h3>
<p>If you need to execute the plugin on machine without any svn in the path you can configure the mojo to use the svnjava provider.</p>
<p>NOTE the svnjava provider use the svnjava scm provider implementation <a class="externalLink" href="http://code.google.com/a/apache-extras.org/p/maven-scm-provider-svnjava/">maven-scm-provider-svnjava</a> which rely on svnkit version.</p>
<div class="source">
<pre>  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
        &lt;artifactId&gt;buildnumber-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;1.4-SNAPSHOT&lt;/version&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;phase&gt;validate&lt;/phase&gt;
            &lt;goals&gt;
              &lt;goal&gt;create&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
        &lt;configuration&gt;
          &lt;doCheck&gt;true&lt;/doCheck&gt;
          &lt;doUpdate&gt;true&lt;/doUpdate&gt;
          &lt;providerImplementations&gt;
            &lt;svn&gt;javasvn&lt;/svn&gt;
          &lt;/providerImplementations&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;</pre></div></div>
<div class="section">
<h3><a name="Using_Perforce_P4Maven_provider"></a>Using Perforce P4Maven provider</h3>
<p>To use this plugin with <a class="externalLink" href="https://swarm.workshop.perforce.com/files/guest/dantran/p4maven">Perforce P4Maven Provider</a>, add p4maven-provider to dependencies list.</p>
<div class="source">
<pre>  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
        &lt;artifactId&gt;buildnumber-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;1.4-SNAPSHOT&lt;/version&gt;
        &lt;dependencies&gt;
          &lt;dependency&gt;
            &lt;groupId&gt;com.perforce.p4maven&lt;/groupId&gt;
            &lt;artifactId&gt;p4maven-provider&lt;/artifactId&gt;
            &lt;version&gt;${p4maven.version}&lt;/version&gt;
          &lt;/dependency&gt;
        &lt;/dependencies&gt;
        [...]
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;</pre></div></div>
<div class="section">
<h3><a name="Create_Build_Metadata"></a>Create Build Metadata</h3>
<p>For quick quick discovery of a SCM revision of an snapshot/release artifact available at maven repository, use buildnumber:create-metadata to deploy a build metadata file associate with a specific artifact of the same project.</p>
<div class="source">
<pre>  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
        &lt;artifactId&gt;buildnumber-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;1.4-SNAPSHOT&lt;/version&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;phase&gt;generate-ressources&lt;/phase&gt;
            &lt;goals&gt;
              &lt;goal&gt;create-metadata&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
        &lt;configuration&gt;
          &lt;attach&gt;true&lt;/attach&gt;
          &lt;!--make it available for jar/war classpath resource --&gt;
          &lt;addOutputDirectoryToResources&gt;true&lt;/addOutputDirectoryToResources&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;</pre></div></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                    2007-2015
                        <a href="http://codehaus.org">Codehaus</a>.
            All Rights Reserved.      
                    
      </div>

        
        
          
    
    
                
    <div id="ohloh" class="pull-right">
      <script type="text/javascript" src="http://www.ohloh.net/p/5211/widgets/project_thin_badge.js"></script>
    </div>
        </div>
    </footer>
  </body>
</html>
